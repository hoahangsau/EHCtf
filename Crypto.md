<h1>Crypto01</h1>
<h2>Problem</h2>
<pre>
from Crypto.Cipher import AES 
from Crypto.Util import Counter
import os

flag = b'EHCTF{REDACTED}'

key = os.urandom(16)

def encrypt(pt):
    cipher = AES.new(key, AES.MODE_CTR, counter=Counter.new(128))
    ct = cipher.encrypt(pt)
    return ct

qoute = b'What has two eyes but can not see? It is you!'

print(encrypt(qoute))
print(encrypt(flag))</pre>

Output cho đoạn code trên
<pre>
b'\x10\x0f\xef\x03\x148\xcf\x96\xa3\x83\x82\xbd\x10\x088\t\xc9S\x0b\xb1\x03\xdfJ2m;\x93Q\xf6\t\xcd\xfah\xb4\x16\x0e\xdc\xa0>-\x16\xae\x1dh\x00'
b'\x02/\xcd#r+\xc4\x90\xb6\xc0\xaa\xe6o\x1fr\x19\x8f@\r\x9b\x1c\xccP\x0ct/\x8fS\xf7Y\xe1\xfce\xbfZ+\x9b\xeenmK'
</pre>

<h2>Solution</h2>
<pre>from pwn import xor
ciphertext1 = b'\x10\x0f\xef\x03\x148\xcf\x96\xa3\x83\x82\xbd\x10\x088\t\xc9S\x0b\xb1\x03\xdfJ2m;\x93Q\xf6\t\xcd\xfah\xb4\x16\x0e\xdc\xa0>-\x16\xae\x1dh\x00'
ciphertext2 = b'\x02/\xcd#r+\xc4\x90\xb6\xc0\xaa\xe6o\x1fr\x19\x8f@\r\x9b\x1c\xccP\x0ct/\x8fS\xf7Y\xe1\xfce\xbfZ+\x9b\xeenmK'
plaintext1 = b'What has two eyes but can not see? It is you!'
xorkey = xor(ciphertext1, ciphertext2)
flag = xor(xorkey,plaintext1)
print(flag)</pre>

Vì đoạn AES CTR encrypt trên sử dụng cùng một key và vector value để mã hóa nên ta có thể rút ra được:
<pre>ciphertext1 XOR ciphertext2 =  plaintext1 XOR AES(key, IV) XOR plaintext2 XOR AES(key, IV)</pre>
Theo tính chất nghịch đảo(key xor key = 0) và tính chất đối xứng của XOR, ta có được: 
<pre> plaintext2 = ciphertext1 XOR ciphertext2 XOR plaintext1</pre>
=>FLAG: EHCTF{ju57_4_r3u53d_k3y_w4rmup_ch4ll3n93}

<h1>Crypto02</h1>
<h2>Problem</h2>

Một vài CTV trong CLB EHC đã thuê một căn homestay tọa lạc tại số nhà 1-42, ngõ 525 đường Hola để cùng nhau học tập chuẩn bị cho cuộc thi EHCTF-2024 sắp tới. Họ đã thuê được căn homestay này với giá siêu ưu đãi, 0 đồng! Tuy nhiên, trong căn homestay này ẩn chứa một bí mật. Dựa trên những con số mà họ tìm thấy xung quanh căn homestay này, cùng với bức ảnh dưới đây, họ đã tạo nên được một phương trình. Sau khi giải phương trình này, họ đã thu được ba con số mà khi tổng hợp ba con số này, họ thu được giá trị đại diện cho câu trả lời cho câu hỏi cuối cùng về sự sống, vũ trụ và vạn vật. Liệu bạn có đoán được ba con số mà họ đã tìm ra, cũng như giá trị trên không?

Câu trả lời sẽ có dạng: EHCTF{i_j_k_l}, với i, j, k là ba số bạn tìm ra theo thứ tự tăng dần và l là giá trị đại diện trên.

<h2>Solution</h2>

Sau khi tổng hợp các con số đề bài cho và bức ảnh hint được đưa

![image](https://github.com/hoahangsau/EHCtf/assets/153940762/ca729209-c7e3-442b-a133-16a46f23148f)


ta có một phương trình bậc 4: x^4 + 42x^3 + 525x^2 + 2024x +e =0

Sau khi giải bằng casio sẽ ra được 4 nghiệm: 0, -8, -11,-23. Ba con số để cho vào flag chính là -8,-11,-23. Sau khi tổng hợp 3 số này sẽ cho kết quả là 42 trùng hợp với con số đại diện cho sự sống, vũ trụ vạn vật mà đề bài nhắc tới.
![Screenshot 2024-04-29 145855](https://github.com/hoahangsau/EHCtf/assets/153940762/d1d558ef-4e49-4228-8d9b-856a1cc3c827)


=>FLAG: EHCTF{-23_-11_-8_42}

<h1>Crypto03</h1>
<h2>Problem</h2>
<Pre>
from Crypto.Util.number import *
from sympy import nextprime

flag = b'EHCTF{REDACTED}'

p = getPrime(1024)
q = nextprime(p)
e = 65537

n = p * q
c = pow(bytes_to_long(flag), e, n)

print(f"n = {n}")
print(f"c = {c}")

</Pre>

Output:
<PRE>n = 20159884168863899177128175715030429666461733285660170664255048579116265087763268748333820860913271674586980839088092697230336179818435879126554509868570255414201418619851045615744211750178240471758695923469393333600480843090831767416937814471973060610730578620506577745372347777922355677932755542699210313287595362584505135967456855068550375989801913361017083952090117041405458626488736811460716474071561590513778196334141517893224697977911862004615690183334216587398645213023148750443295007000911541566340284156527080509545145423451091853688188705902833261507474200445477515893168405730493924172626222872760780966427
c = 5590290988048987395386654580217627891323285179623730517706046941330631751091704469197104659925631488245157013703939851889100648227366701645585621491038275140343378735730791279203898144553729328941398188415067592036721280652305025939405084758866839538232465982432598880063817303013941286752897017953233595030374447787155426218975962806013766789948077237198249681698873388633874314143308172961494897366805819940483565114559519130269883168643117283513377057518341181028637276121523558435379680842858654842063020671869735388720661080121671859283932413853692136521020202441445689535768048522496377594975744450862121375446</PRE>

<h2>Solution</h2>

Để phân tích thừa số nguyên tố, mình sử dụng tool factordb, nhưng tool này không phân tích được con số đề bài cho nên mình dùng dCode
![Screenshot 2024-04-29 151008](https://github.com/hoahangsau/EHCtf/assets/153940762/5928d4ee-94d5-4cf6-ba37-7695cc37a9d9)

Sau khi có p và q thì chúng ta sẽ decrypt RSA thông thường
<pre>
from Crypto.Util.number import inverse, long_to_bytes
n = 20159884168863899177128175715030429666461733285660170664255048579116265087763268748333820860913271674586980839088092697230336179818435879126554509868570255414201418619851045615744211750178240471758695923469393333600480843090831767416937814471973060610730578620506577745372347777922355677932755542699210313287595362584505135967456855068550375989801913361017083952090117041405458626488736811460716474071561590513778196334141517893224697977911862004615690183334216587398645213023148750443295007000911541566340284156527080509545145423451091853688188705902833261507474200445477515893168405730493924172626222872760780966427
c = 5590290988048987395386654580217627891323285179623730517706046941330631751091704469197104659925631488245157013703939851889100648227366701645585621491038275140343378735730791279203898144553729328941398188415067592036721280652305025939405084758866839538232465982432598880063817303013941286752897017953233595030374447787155426218975962806013766789948077237198249681698873388633874314143308172961494897366805819940483565114559519130269883168643117283513377057518341181028637276121523558435379680842858654842063020671869735388720661080121671859283932413853692136521020202441445689535768048522496377594975744450862121375446
e = 65537
p = 141985506897231941308512923885300128905042311260138568794604206121080701727914934144982091139843178794485634682609841794924046596349428012470654095827271229332196334064446305896952838867217202135745989681311949561794583125471246401285687229433924674917884710139141784537370509554520561718028000388149962362681
q = 141985506897231941308512923885300128905042311260138568794604206121080701727914934144982091139843178794485634682609841794924046596349428012470654095827271229332196334064446305896952838867217202135745989681311949561794583125471246401285687229433924674917884710139141784537370509554520561718028000388149962362867
phi = (p-1)*(q-1)
d = inverse(e,phi)
flag = pow(c,d,n)
print(long_to_bytes(flag))</pre>

=> FLAG: EHCTF{d0_n07_b3_700_cl0s3}



